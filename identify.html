<!DOCTYPE html>
<html>
	<head>
		<script src="/socket.io/socket.io.js"></script>
		<style>
			@font-face {
				 font-family: "Whitney";
				 src: url("/assets/whitneymedium.otf");
			}
			
			#usersList, input, #usersListSelected{
				--font-primary: Whitney,"Helvetica Neue",Helvetica,Arial,sans-serif;
				--text-normal: #dcddde;
				--deprecated-text-input-bg: rgba(0,0,0,0.1);
				--deprecated-text-input-border: rgba(0,0,0,0.3);
				user-select: none;
				pointer-events: all;
				-webkit-box-direction: normal;
				font-weight: 400;
				font-family: var(--font-primary);
				text-rendering: optimizeLegibility;
				outline: 0;
				font-size: 16px;
				box-sizing: border-box;
				width: 100%;
				border-radius: 3px;
				color: var(--text-normal);
				background-color: var(--deprecated-text-input-bg);
				border: 1px solid var(--deprecated-text-input-border);
				transition: border-color .2s ease-in-out;
				padding: 10px;
				width:250px;
				//height: 120px;
				margin:auto;
			}
			input{
				height: 40px;
			}
			.img-valign {
			  vertical-align: middle;
			  margin-bottom: 0.50em;
			}
		</style>
		<link rel="stylesheet" href="styles/buttons.css">
	</head>
	<body bgColor="#2c2f33" style="text-align:center;color:white;font-family:Whitney;">
		<header style="background-color:#23272a; padding:10px">
			<b>Bienvenue sur FileLocker ! Gérez vous partage de fichiers en toute sécurité !</b></header>
        <header style="background-color:#23272a; padding:10px;text-align:center;">
<u>FileLocker ? C'est quoi ?</u>
<br>
<br>FileLocker est un site qui vous permet de partager des fichiers, à d'autre personnes.
<br>Vous pouvez choisir également à qui vous voulez partager ces fichers.
<br>
<br>
<br>
<br><u>Comment ça marche ?</u>
<br>
<br>En fait, ce que fait FileLocker, c'est de verifier que votre compte Discord ait été choisi par l'émetteur du fichier à partager.
<br> - Si vous êtes l'émetteur, il vous suffira de vous connecter, puis de séléctionner qui peut voir les messages en tapant le pseudo de la personne à qui l'envoyer.
<br> - Si vous êtes le récépteur, vous avez de toute façon besoin d'un compte Discord pour accéder au fichier de l'émetteur, afin de vous identifier, et pouvoir vérifier que vous pouvez voir le fichier.
<br>
<br>
<br><u>Intéressant... Et il faut nécessairement un compte Discord ?</u>
<br>
<br>Oui. Le site est prévu pour faire des partages de fichiers via Discord et pour Discord.
<br>L'aventage, c'est que vous pouvez faire des partages sur un salon Discord que tout le monde utilise et dont tous le monde à accès.
<br>
<br>
<br><u>Mais... Pour partager des fichiers, il y a les messages privés, où les groupes privés, non ?</u>
<br>
<br>En effet. Mais supposons que le destinataire ait sa messagerie privée Discord fermée au public, vous pouvez quand même lui envoyer le fichier de manière sécurisée.
<br>Pour ce qui est des groupes privés, nous rappellons qu'il sont limités à 10 membres. FileLocker n'a pas de nombre de destinataires limités, vous pouvez donc envoyer vos fichers à autant de personnes que vous voulez.
<br>
<br>
<br><u>Et il y a besoin de quelque chose pour partager mon fichier ?</u>
<br>
<br>Il vous faut juste le bot discord sur votre serveur, pour qu'il puisse récuperer la liste des membres, afin de définir les utilisateurs à qui envoyer le fichier.
<br>Pour finir, sachez que le fait de vous identifier ne vous inscrit pas chez nous, c'est une identification temporaire, donc pas de mot de passe à retenir, juste celui de votre compte Discord.
<br>
<br>
<br><u>Et si je trouve des bugs ? Je fais quoi ?</u>
<br>
<br>Si vous êtes témoins de bugs, où que vous avez des idées de rajouts, veuillez contacter <b>Vixen#8177</b> ou <b>RoxasYTB#1966</b>.
<br>
<br>
<br>
<br><b>À présent, si vous voulez utiliser nos services, veuillez vous identifiez en utilisant le bouton bleu ci-dessous.
<br>Et nous vous remercions encore de nous faire confiance, merci d'utiliser FileLocker !</b>
		</header>
		<br>
		<br>
		<a id="login"><button class="blue">Cliquez ici pour vous identifier</button></a>
	</body>
<script>
fetch("/authLink")
.then(res=>res.text())
.then((resp)=>{
	//console.log(resp)
  if(!localStorage.myData)
	  document.getElementById("login").href = resp
  else
    document.getElementById("login").href = "/logged"
})
function generateRandomString() {
	let randomString = '';
	const randomNumber = Math.floor(Math.random() * 10);

	for (let i = 0; i < 20 + randomNumber; i++) {
		randomString += String.fromCharCode(33 + Math.floor(Math.random() * 94));
	}

	return randomString;
}
	window.onload = () => {
		const fragment = new URLSearchParams(window.location.hash.slice(1));
		const [accessToken, tokenType, state] = [fragment.get('access_token'), fragment.get('token_type'), fragment.get('state')];

		if (!accessToken) {
			const randomString = generateRandomString();
			localStorage.setItem('oauth-state', randomString);

			//document.getElementById('login').href += `&state=${btoa(randomString)}`;
			return document.getElementById('login').style.display = 'block';
		}

		fetch('https://discord.com/api/users/@me', {
			headers: {
				authorization: `${tokenType} ${accessToken}`,
			},
		})
			.then(result => result.json())
			.then(response => {
				const { username, discriminator } = response;
				document.getElementById('info').innerText += ` ${username}#${discriminator}`;
			})
			.catch(console.error);
	};
</script>
</body>
</html>